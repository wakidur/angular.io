{
  "version": 3,
  "file": "outside-event-plugin.js",
  "sources": [
    "ng://ngx-modialog/projects/ngx-modialog/src/lib/providers/outside-event-plugin.ts"
  ],
  "sourcesContent": [
    "// heavily inspired by:\n// http://www.bennadel.com/blog/3025-creating-custom-dom-and-host-event-bindings-in-angular-2-beta-6.htm\n\nimport { Injectable } from '@angular/core';\nimport { EventManager } from '@angular/platform-browser';\nimport { noop } from '../framework/utils';\n\n// TODO: use DI factory for this.\n// TODO: consolidate dup code\nconst isDoc: boolean = !(typeof document === 'undefined' || !document);\n\nconst eventMap = {\n    clickOutside: 'click',\n    mousedownOutside: 'mousedown',\n    mouseupOutside: 'mouseup',\n    mousemoveOutside: 'mousemove'\n};\n\n/**\n * An event handler factory for event handlers that bubble the event to a given handler\n * if the event target is not an ancestor of the given element.\n * @param element\n * @param handler\n */\nfunction bubbleNonAncestorHandlerFactory(element: HTMLElement, handler: (event) => void) {\n    return (event) => {\n        let current = event.target;\n        do {\n            if (current === element) {\n                return;\n            }\n        } while (current.parentNode && ( current = current.parentNode ));\n\n        handler(event);\n    };\n}\n\n@Injectable()\nexport class DOMOutsideEventPlugin { // extends EventManagerPlugin\n    manager: EventManager;\n\n    constructor() {\n    if (!isDoc || typeof document.addEventListener !== 'function') {\n        this.addEventListener = noop as any;\n    }\n    }\n\n    supports(eventName: string): boolean {\n        return eventMap.hasOwnProperty(eventName);\n    }\n\n    addEventListener(element: HTMLElement, eventName: string, handler: Function): Function {\n        const zone = this.manager.getZone();\n\n        // A Factory that registers the event on the document, instead of the element.\n        // the handler is created at runtime, and it acts as a propagation/bubble predicate, it will\n        // bubble up the event (i.e: execute our original event handler) only if the event targer\n        // is an ancestor of our element.\n        // The event is fired inside the angular zone so change detection can kick into action.\n        const onceOnOutside = () => {\n            const listener =\n              bubbleNonAncestorHandlerFactory(element, evt => zone.runGuarded(() => handler(evt)));\n\n            // mimic BrowserDomAdapter.onAndCancel\n            document.addEventListener(eventMap[eventName], listener, false);\n            return () => document.removeEventListener(eventMap[eventName], listener, false);\n        };\n\n        // we run the event registration for the document in a different zone, this will make sure\n        // change detection is off.\n        // It turns out that if a component that use DOMOutsideEventPlugin is built from a click\n        // event, we might get here before the event reached the document, causing a quick false\n        // positive handling (when stopPropagation() was'nt invoked). To workaround this we wait\n        // for the next vm turn and register.\n        // Event registration returns a dispose function for that event, angular use it to clean\n        // up after component get's destroyed. Since we need to return a dispose function\n        // synchronously we have to put a wrapper for it since we will get it asynchronously,\n        // i.e: after we need to return it.\n        //\n        return zone.runOutsideAngular(() => {\n            let fn: Function;\n            setTimeout(() => fn = onceOnOutside(), 0);\n            return () => {\n                if (fn) fn();\n            };\n        });\n    }\n\n}\n"
  ],
  "names": [],
  "mappings": ";;;;;;AAGA,OAAO,EAAE,UAAU,EAAE,MAAM,eAAe,CAAC;AAE3C,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;;;AAI1C,uBAAM,KAAK,GAAY,CAAC,CAAC,OAAO,QAAQ,KAAK,WAAW,IAAI,CAAC,QAAQ,CAAC,CAAC;AAEvE,uBAAM,QAAQ,GAAG;IACb,YAAY,EAAE,OAAO;IACrB,gBAAgB,EAAE,WAAW;IAC7B,cAAc,EAAE,SAAS;IACzB,gBAAgB,EAAE,WAAW;CAChC,CAAC;;;;;;;;AAQF,yCAAyC,OAAoB,EAAE,OAAwB;IACnF,MAAM,CAAC,CAAC,KAAK,EAAE,EAAE;QACb,qBAAI,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC;QAC3B,GAAG,CAAC;YACA,EAAE,CAAC,CAAC,OAAO,KAAK,OAAO,CAAC,CAAC,CAAC;gBACtB,MAAM,CAAC;aACV;SACJ,QAAQ,OAAO,CAAC,UAAU,IAAI,CAAE,OAAO,GAAG,OAAO,CAAC,UAAU,CAAE,EAAE;QAEjE,OAAO,CAAC,KAAK,CAAC,CAAC;KAClB,CAAC;CACL;AAGD,MAAM;IAGF;QACA,EAAE,CAAC,CAAC,CAAC,KAAK,IAAI,OAAO,QAAQ,CAAC,gBAAgB,KAAK,UAAU,CAAC,CAAC,CAAC;YAC5D,IAAI,CAAC,gBAAgB,qBAAG,IAAW,CAAA,CAAC;SACvC;KACA;;;;;IAED,QAAQ,CAAC,SAAiB;QACtB,MAAM,CAAC,QAAQ,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;KAC7C;;;;;;;IAED,gBAAgB,CAAC,OAAoB,EAAE,SAAiB,EAAE,OAAiB;QACvE,uBAAM,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;;;;;;QAOpC,uBAAM,aAAa,GAAG,GAAG,EAAE;YACvB,uBAAM,QAAQ,GACZ,+BAA+B,CAAC,OAAO,EAAE,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;;YAGvF,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;YAChE,MAAM,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,mBAAmB,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;SACnF,CAAC;;;;;;;;;;;;QAaF,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,GAAG,EAAE;YAC/B,qBAAI,EAAY,CAAC;YACjB,UAAU,CAAC,GAAG,EAAE,CAAC,EAAE,GAAG,aAAa,EAAE,EAAE,CAAC,CAAC,CAAC;YAC1C,MAAM,CAAC,GAAG,EAAE;gBACR,EAAE,CAAC,CAAC,EAAE,CAAC;oBAAC,EAAE,EAAE,CAAC;aAChB,CAAC;SACL,CAAC,CAAC;KACN;;;YAjDJ,UAAU"
}
